La interpolación es el proceso de aproximación de los valores en un intervalo en el que sólo conocemos los extremos inferior y superior. Así por ejemplo en el conjunto ordenado de valores:

$$
1, 3, 5, 7
$$

es posible inferir que los valores intermedios son:

$$
2, 4, 6
$$

asumiendo que entre cada observación $1, 3, 5, 7$, los valores intermedios se pueda aproximar linealmente.

En modelado espacial, la interpolación se utiliza muy frecuentemente para generar capas ráster a partir de mediciones en puntos, como aquellas que utilizamos en correlación y regresión. El fin último de la interpolación es la predecir la variación espacial de los valores de la variable que medimos.

Así como rellenamos los valores intermedios en la secuencia $1, 3, 5, 7$ asumiento linealidad, hay muchos otros métodos para predicción de valores ordenados de manera más compleja y en dos dimensiones.

Algunas de las técnicas más comunes para predicción espacial son:

1. Inverso de la distancia
2. Vecino más próximo
3. Regresión sobre las coordenadas
4. Splines

### Inverso de la distancia (IDW en inglés)

Este método asume que los valores de la variable interpolada entre los puntos de referencia cambia en relación directa con la distancia entre los puntos. Por ejemplo, Si tenemos dos mediciones de temperatura separadas físicamente 10 km, y queremos estimar la temperatura en los puntos intermedios con una precisión de 1 km, la temperatura de éstos será proporcional a la diferencie entre las mediciones.

```{r Interp-dist, echo = F, fig.align='center', fig.cap="Interpolación por distancia, los extremos representan los puntos donde fueron obtenidas las mediciones, y los píxeles intermedios fueron rellenados por interpolación."}

knitr::include_graphics("Unidad-II/Interp-distancia.png")
```

### Vecino más próximo

Este es el método de interpolación más sencillo que existe y consiste en asumir que el valor de los píxeles intermedios es equivalente al mismo valor del píxel más cercano.

### Regresión sobre las coordenadas

Es un método sencillo pero efectivo si la variable que queremos interpolar tiene un gradiente a lo largo de la longitud y/o latitud que se puede aproximar por medio de un modelo lineal. La idea es que la variable de respuesta ($y$), sea una función lineal de las coordenadas ($x_1, x_2$):

$$ y(Lat, Lon) = \alpha + \beta_1 Lat + \beta_2 Lon$$

```{r Gradientes, echo=F, fig.align='center', fig.cap="Ejemplos de gradientes lineales con las coordenadas.", fig.height=5, fig.width=10, message=FALSE, warning=FALSE}
x <- seq(0, 1, len = 10)
y <- seq(0, 1, len = 10)

df.1 <- expand.grid(x = x, y = y)

df.1$z1 <- with(df.1, (x + y)/2)
df.1$z2 <- df.1$x

#Muestras
x1 <- runif(20)
y1 <- runif(20)
z1.1 <- (x1 + y1)/2

x2 <- runif(20)
y2 <- runif(20)

library(raster)

r <- rasterFromXYZ(df.1)

par(mfrow = c(1, 2))
plot(r[[1]], main = "Gradiente 1")
points(x1, y1, cex = z1.1*1.5)

plot(r[[2]], main = "Gradiente 2")
points(x2, y2, cex = x2*1.5)
```
Al igual que con los modelos lineales, este tipo de interpolación puede ser muy flexible, aunque cuando la variable dependiente $y$ es poco lineal con respecto de la latitud y longitud se recomienda usar **Splines**

### Splines

Son una metodología muy similar a la regresión por coordenadas pero no asume ningún tipo de relación funcional entre la latitud y longitud y la variable de respuesta. La manera en que funcionan las splines es ajustando líneas de regresión con un polinomio de 2o o 3er grado a porciones específicas de cada variable independiente. El resultado de usar splines pueden ser curvas complejas con un contorno suave.

![](https://i0.wp.com/freakonometrics.hypotheses.org/files/2016/01/splines03.png?w=578&ssl=1)

[Ejemplo de regresión con splines por Arthur Charpentier](https://i0.wp.com/freakonometrics.hypotheses.org/files/2016/01/splines03.png?w=578&ssl=1)

### Tutorial de interpolación en R




