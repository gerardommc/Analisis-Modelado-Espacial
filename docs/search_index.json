[["index.html", "Análisis y Modelado Espacial 1 Preámbulo", " Análisis y Modelado Espacial Gerardo Martín 2022-02-11 1 Preámbulo En el curso Modelado y Análisis Espacial aprenderemos a utilizar algunas herramientas para aprender a usar herramientas geográficas para analizar y representar procesos ambientales en el espacio. Los contenidos del índice se apegan al programa completo del curso, el cual se impartirá en los horarios normales establecidos. Para conocer cuándo, cómo y qué temas se se impartirán puedes consultar la estrategia docente. "],["encuadre-de-la-materia.html", " 2 Encuadre de la materia 2.1 Criterios de evaluación 2.2 ¿Cómo se darán las clases? 2.3 Reglas del salón 2.4 Contacto", " 2 Encuadre de la materia 2.1 Criterios de evaluación Las constribuciones a cada calificación parcial serán: Asistencia (25%) Trabajos de clase cumplidos (50%) Examen (25%) Participación (2 puntos extra máximo) Cabe señalar, que la asistencia no corresponderá con su presencia en las sesiones sincrónicas, sino con el cumplimiento de los trabajos de clase. La participación se medirá tanto por participación directa en las sesiones sincrónicas como por el seguimiento que uds den a la clase por correo electrónico. 2.2 ¿Cómo se darán las clases? Trataré de apegarnos a los tiempos de actividades sincrónicas y asincrónicas establecidos en la estrategia docente, pero éstos son completamente flexibles. Una estrategia que me ha funcionado en cursos anteriores ha sido la de dedicar la última actividad sicrónica de la semana a resolver dudas, es en estas sesiones en las que hay muchas posibilidades de conseguir puntos de participación. Todos los contenidos del curso, lecturas y presentaciones, se irán añadiendo a este sitio web conforme avanza el semestre. En el Google Classroom de la materia se irán anunciando las diferentes actividades y sesiones sincrónicas con anticipación suficiente. Igualmente, los examenes y resultados serán publicados a través de esta plataforma. A petición de uds, también se publicarán aquí los videos de las sesiones sincrónicas que tengamos, en especial para aquellos temas que sean mayor interés/dificultad/importancia. Los trabajos de práctica también se publicarán en Classroom. Para finalizar, las clases sincrónicas estarán almacenadas en la playlist de la clase contenida en mi canal de youtube. 2.3 Reglas del salón Estas, obviamente, son particulares del modelo en línea, por lo tanto aquí van las reglas de zoom: Micrófonos apagados Cámaras prendidas, exceptuando: 2.1. Si su velocidad de internet lo dificulta 2.2. Si tienen datos limitados Hacer muchas preguntas Decirme si paso algo por alto 2.4 Contacto Para reportar fallos, resolver dudas y peticiones especiales grupales o individuales por favor enviar correo electrónico a gerardo.mmc@enesmerida.unam.mx. "],["unidad-i-introducción-al-modelado-espacial.html", " 3 Unidad I: Introducción al modelado espacial 3.1 Análisis utilizando sistemas de información geográfica 3.2 Modelado espacial", " 3 Unidad I: Introducción al modelado espacial 3.1 Análisis utilizando sistemas de información geográfica 3.1.1 Introducción En el mundo moderno hay una gran cantidad de procesos y servicios que utilizan información espacial. Más allá de las aplicaciones comerciales que ya todxs conocemos hoy por hoy, los sistemas de información geográficas (SIG) son altamente necesarios para planear muchas de las actividades de las sociedades, por ejemplo para identificar áreas: donde se permitirá la urbanización prioritarias de conservación donde se puede practicar la agricultura donde se puede producir energías renovables que se pueden ver afectadas por desastres naturales Además de identificación de zonas relevantes, también sirven para la cuantificación tanto de superficies como de poblaciones humanas. En ciencas ambientales, nos interesaría aprender a utilizar los SIG para solventar problemáticas ambientales sobretodo aquellas resultado de las actividades del ser humano. Las soluciones ambientales requieren tanto de la identificación espacial como del monitoreo, manejo y mitigación, cuyo éxito puede depender en gran medida de la disponibilidad de información geográfica. 3.1.2 Ejercicio Visita la página del Socioeconomic Data and Applications Center y navega por los diferentes apartados temáticos que cubren, haciendo una lista con descripciones de mapas que te parezcan interesantes o relevantes. 3.1.3 ¿Qué son los SIG? Los SIG son programas de computadora especializados en el manejo, análisis y visualización de datos geográficos. Estos últimos a grandes rasgos con una descripción numerica o cualitativa que esté georreferenciada, o bien, que represente la forma o algún atributo de un objeto cuya localización se conoce. Los sistemas de información geográfica por lo general utilizan distintos tipo de datos. 3.1.3.1 Imágenes ráster Consisten de píxeles que representan valores con alguna paleta de colores Figura 3.1: Ejemplo de capa ráster de algún atributo ambiental de la isla de Sri Lanka. Cada píxel mide 5 x 5 km. 3.1.3.2 Capas vectoriales Pueden representar tanto polígonos como líneas. Los polígonos son utilizados para representar entidades políticas como los países o estados. Las capas vectoriales de líneas pueden utilizarse para representar ríos o caminos ## OGR data source with driver: ESRI Shapefile ## Source: &quot;/home/gerardo/Documentos/Cosas ENES/Materias/LCA/Analisis-Modelado-Espacial/Unidad-I/SL-1/LKA_adm1.shp&quot;, layer: &quot;LKA_adm1&quot; ## with 25 features ## It has 14 fields ## Integer64 fields read as strings: ID_0 ID_1 CCN_1 Figura 3.2: Polígono vectorial muestra la isla de Sri Lanka y su división política en distritos. ## OGR data source with driver: ESRI Shapefile ## Source: &quot;/home/gerardo/Documentos/Cosas ENES/Materias/LCA/Analisis-Modelado-Espacial/Unidad-I/Roads/LKA_roads.shp&quot;, layer: &quot;LKA_roads&quot; ## with 500 features ## It has 5 fields Figura 3.3: Capa lineal muestra la red de carreteras principales de la isla de Sri Lanka. 3.1.3.3 Puntos Son conjuntos de coordenadas geográficas (\\(x, y\\)) cartesianas para identificar la localización de un objeto en el espacio. Figura 3.4: Puntos muestran el valor de una medición de alguna variable ambiental en la isla de Sri Lanka. 3.1.3.4 Ejercicio Vuelve a visitar el Socioeconomic Data and Applications Center y clasifica los mapas que seleccionaste anteriormente de acuerdo con el tipo de datos que consideres que contiene cada uno. 3.1.4 ¿Cómo puedo conseguir un SIG? Al igual que con los sistemas operativos (Windows, Mac) y las suites de ofimática (Google Docs, MS Office, Libre Office), existen alternativas tanto comerciales (de pago y código cerrado) como libres (tanto de pago –gratis– como de código fuente). Uno de los SIG más completos que existen es ArcGIS, sin embargo costo de la licencia es bastante alto. PAra evitar la necesidad de pagar licencias, en este curso, utilizaremos QGIS (Quantum GIS), Saga y R, pues son gratuitos y cubren todas las necesidades del curso y muchas más. De hecho, estas herramientas son sumamente competentes tanto para estudiantes como para profesionales que requieren de aplicaciones sofisticadas, por lo que la relación costo-beneficio es insuperable. Para instalar QGIS visita la página web y sigue las instrucciones de instalación para tu sistema operativo. Los demás programas los instalaremos en otra ocasión. 3.2 Modelado espacial El modelado y análisis espacial puede ser tan variado como los tipos de datos y variables que se pueden representar en el espacio. De manera resumida, el modelado espacial es el desarrollo de representaciones espaciales de añgún fenómeno. Los modelos espaciales pueden ser sencillos, producto de operaciones aritméticas entre distintas variables espacializadas, ó de complejos análisis estadísticos. En este curso veremos aplicaciones de ambas, aunque por su utilidad nos enfocaremos más en los análisis estadísticos. Los modelos espaciales pueden estar basados en, o utilizar, datos geográficos de cualquier naturaleza: vectores, puntos o ráster. Los productos de estas diferentes naturalezas, utilizados para construir modelos espaciales pueden provenir de muchas fuentes, incluso ser colectados por nosotrxs mismxs. Las fuentes de información para construir los modelos espaciales dependerán de muchos factores como la extensión geográfica. Para regiones pequeñas es perfectamente factible hacerlo nosotrxs mismos, pero para estudios a mayor escala, debemos utilizar repositorios públicos de información que veremos más adelante. A continuación se muestran algunos ejemplos de procesamiento estadístico. 3.2.1 Datos vectoriales Ejemplos clásicos abundan en la literatura médica, donde típicamente se analiza el número de casos por polígono de alguna enfermedad. Estos análisis consisten, en esencia, de una regresión lineal, donde la variable de respuesta está medida para cada uno de los polígonos de la capa vectorial, y van acompañados de mediciones de alguna(s) variables de respuesta. El ejemplo de abajo, sin embargo es un poco más complicado pues toma en cuenta la similitud entre polígonos vecinos. La escala de colores indica el número de casos por unidad espacial, y esta representación se llama coropleta. Casos de cancer labial en Escocia 3.2.2 Ráster Un tipo de análisis de imágenes ráster muy útil es el desarrollo de mapas de uso de suelo. También existen otras aplicaciones como la estimación de densidad poblacional de humanos a partir de imágenes satelitales. Estimación de densidad poblacional combinando imágenes satelitales y vectoriales 3.2.3 Puntos Un ejemplo de este tipo de análisis es el modelado de nichos ecológicos y áreas de distribución, y consiste en utilizar los datos de puntos para generar un ráster que representa la favorabilidad ambiental para un organismo. Registros de ocurrencia de la serpiente venenosa Bungarus caeruleus y su abundancia potencial estimada en la isla de Sri Lanka 3.2.4 Lecciones El modelado espacial se distingue de otros tipos de modelación en que, mientras los datos pueden representar mediciones de variables no espaciales (temperatura, tamaño de población, tipo de cobertura vegetal), los datos están descritos por su ubicación espacial y tipo de representación en el espacio. En ocasiones es necesario tomar en cuenta dichas descripciones sobre la situación espacial para hacer el análisis debido a la primera ley de la geografía: “Los objetos cercanos son más similares entre sí” A este fenómeno se le conoce como autocorrelación espacial, es decir que una variable con estructura espacial estará correlacionada consigo misma (casi siempre). Por ejemplo en la base de datos de cancer labial, podemos ver que los distritos vecinos tienen niveles de enfermedad más parecidos entre sí. 3.2.4.1 La estructura espacial Cuando decimos que una base de datos está estructurada quiere decir que cada observación tiene un lugar exacto dentro de la base. El ejemplo más sencillo es de una serie temporal, donde los datos están ordenados en relación al tiempo en que fueron colectados, y sus valores también dependen del tiempo (3.5). Figura 3.5: Estructura temporal de una base de datos La repercusión estadística de la estructuración temporal o espacial de los datos es que las observaciones cercanas en el tiempo o espacio no son independientes entre sí. Las observaciones independientes deberían poder tener cualquiera de los valores posibles en la distribución de la variable, pero las observaciones más cercanas tienen valores más parecidos. Por lo tanto es necesario, en muchas ocasiones, utilizar métodos estadísticos que permitan separar esos efectos de la proximidad espacial o temporal de los efectos de otras variables (temperatura, vegetación, etc.). A este fenómeno se le conoce como Autocorrelación espacial o temporal, es decir, que una variable está correlacionada consigo misma. Figura 3.6: Ejemplos de capas ráster con y sin autocorrelación. Los métodos que combinan la modelación estadística y aquellos utilizados para medir y estimar la autocorrelación, son lo que distingue a la modelación estadística de la modelación espacial. 3.2.5 Repositorios públicos gratuitos Áreas administrativas del mundo Clima multidécadas CHELSA Clima multidécadas WorldClim Población y demografía del mundo Socio-economía y aplicaciones Uso de suelo Copernicus (Agencia espacial europea) Características del suelo Ocurrencia de especies GBIF Ocurrencia de especies VertNet Ocurrencia de especies Naturalista Distribución de reptiles y anfibios Sensores remotos "],["unidad-ii-análisis-de-la-asociación-espacial-entre-varios-fenómenos.html", " 4 Unidad II - Análisis de la asociación espacial entre varios fenómenos 4.1 Correlación y regresión espacial 4.2 Análisis de asociación espacial 4.3 Interpolación", " 4 Unidad II - Análisis de la asociación espacial entre varios fenómenos La asociación espacial es el pilar del análisis espacial, y consiste principalmente en medir el grado de dependencia entre dos variables con estructura espacial. 4.1 Correlación y regresión espacial 4.1.1 Correlación espacial La correlación mide la similitud entre dos variables aleatorias, comparando sus varianzas respectivas. Es una prueba muy sencilla, pero que tiene muchas fallas, por ejemplo, no podemos saber si la correlación es causal. Veamos dos ejemplos de correlación entre dos variables ambientales, uno donde hay una alta correlación y otro donde no la hay. Figura 4.1: Variables altamente correlacionadas. Los mapas muestran los valores de dos capas ráster, y la gráfica de dispersión contiene los valores de cada píxel, en el eje x, la variable de la izquieda, y el eje y la variable de la derecha. Figura 4.2: Variables pobremente correlacionadas. Claramente en el ejemplo de la figura 4.1, una de las variables predice a la otra, pero no sabemos cuál produce a cuál, o si ambas sor producidas por otra variable que no se ha medido. En resumidas cuentas, la correlación no se puede utilizar para analizar causalidad, lo cual es común a todos los análisis estadísticos. 4.1.1.1 Breve recordatorio del cálculo de la correlación Como ya han de saber, la correlación es una prueba de estadística frecuentista paramétrica. Como tal, consiste en una serie de cáculos aritméticos para obtener un parámetro \\(r\\): \\[\\begin{equation} r = \\frac{\\sum x_1 x_2}{\\sqrt{\\sum x_1^2 \\sum x_2^2}} \\end{equation}\\] donde \\(x_1\\) y \\(x_2\\) son las dos variables centradas (variable menos la media aritmética), cuya correlación queremos medir. Esta prueba de correlación se llama de Pearson, y existen algunas modificaciones para datos de otra naturaleza como los ordinales, para lo cual se utiliza la correlación de Spearman. El coeficiente de correlación de esta última se denota con \\(\\rho\\). La correlación de Spearman es menos sensible que la de Pearson a correlaciones no lineales, por lo que si la gráfica de las variables \\(x_1, x_2\\) no forma una línea recta como en 4.1, se puede probar con la correlación de Spearman. 4.1.1.2 Correlación en R Medir la correlación entre dos variables espaciales en R es muy fácil, aunque antes de proseguir, debemos aprender a manejar los datos espaciales en R. Como ya han de saber, cuando no podemos hacer algo en R básico, hay que echar un vistazo a las librerías. Las más potentes para manejar datos espaciales son raster y rgdal. La primera, como su nommbre indica, sirve principalmente para imágenes, la segunda, para vectores y puntos. Ambas son compatibles, es decir se pueden hacer procesos espaciales combinando los objetos de R que ambos paquetes utilizan. Vamos a leer un raster con la paquetería raster y la función del mismo nombre: library(raster) r &lt;- raster(&quot;Capas-ejemplo/bio1.tif&quot;) El nombre del achivo es bio1.tif y está contenido en la carpeta “Capas ejemplo.” Para hacer una prueba de correlación, necesitamos leer otra capa: r1 &lt;- raster(&quot;Capas-ejemplo/bio11.tif&quot;) y las vamos a agrupar en un objeto para hacer la prueba de correlación con la función pairs del mismo paquete raster: st &lt;- stack(r, r1) pairs(st) Como podemos ver, la función pairs hace un gráfica con los histogramas de cada variable (en verde), el gráfico de dispersión, y el coeficiente de correlación de Pearson. Vamos a ver entonces qué está haciedo la función pairs Vamos a transformar sl objeto st en una tabla con dos columnas para las coordenadas geográficas de cada píxel y otras dos para los valores de cada variable: t1 &lt;- rasterToPoints(st) t1 &lt;- data.frame(t1) knitr::kable(head(t1)) x y bio1 bio11 -126.1714 59.93903 -34 -208 -126.0047 59.93903 -40 -206 -125.8380 59.93903 -43 -204 -125.6714 59.93903 -41 -202 -125.5047 59.93903 -42 -201 -125.3380 59.93903 -42 -200 Como sabemos el coeficiente de correlación de Pearson utiliza dos cálculos, \\(\\sum x_1 x_2\\) y \\(\\sqrt{\\sum x_1^2 \\sum x_2^2}\\). Vamos a hacerlos a continuación: x1 &lt;- t1$bio1; x2 &lt;- t1$bio11 x1 &lt;- x1-mean(x1); x2 &lt;- x2-mean(x2) calc.1 &lt;- sum(x1 * x2) calc.2 &lt;- sqrt(sum(x1^2) * sum(x2^2)) coef.pearson &lt;- calc.1/calc.2 coef.pearson ## [1] 0.9689097 4.1.2 Regresión 4.2 Análisis de asociación espacial 4.3 Interpolación "],["unidad-iii.html", " 5 Unidad III", " 5 Unidad III "],["unidad-iv.html", " 6 Unidad IV", " 6 Unidad IV "],["unidad-v.html", " 7 Unidad V", " 7 Unidad V "],["unidad-vi.html", " 8 Unidad VI", " 8 Unidad VI "],["references.html", "References", " References "]]
